import { convert } from 'url-slug'

export const unaccentize = (string: string): string => {
  const accents: { [index: string]: string } = {
    a: 'á|à|ã|â|ä|À|Á|Ã|Â|Ä',
    e: 'é|è|ê|ë|É|È|Ê|Ë',
    i: 'í|ì|î|ï|Í|Ì|Î|Ï',
    o: 'ó|ò|ô|õ|ö|Ó|Ò|Ô|Õ|Ö',
    u: 'ú|ù|û|ü|Ú|Ù|Û|Ü',
    c: 'ç|Ç',
    n: 'ñ|Ñ',
  }

  let result = string
  Object.keys(accents).forEach((key) => {
    result = result.replace(new RegExp(accents[key], 'g'), key)
  })

  return result
}

export const toContentSlug = (string: string): string => {
  if (!string || string.length === 0) {
    return ''
  }

  const rawStopWords: string[] = [
    'a',
    'ai',
    'aie',
    'aient',
    'aies',
    'ait',
    'as',
    'au',
    'aura',
    'aurai',
    'auraient',
    'aurais',
    'aurait',
    'auras',
    'aurez',
    'auriez',
    'aurions',
    'aurons',
    'auront',
    'aux',
    'avaient',
    'avais',
    'avait',
    'avec',
    'avez',
    'aviez',
    'avions',
    'avons',
    'ayant',
    'ayante',
    'ayantes',
    'ayants',
    'ayez',
    'ayons',
    'c',
    'ces',
    'd',
    'dans',
    'de',
    'des',
    'du',
    'elle',
    'en',
    'es',
    'est',
    'et',
    'eu',
    'eue',
    'eues',
    'eurent',
    'eus',
    'eusse',
    'eussent',
    'eusses',
    'eussiez',
    'eussions',
    'eut',
    'eux',
    'eûmes',
    'eût',
    'eûtes',
    'furent',
    'fus',
    'fusse',
    'fussent',
    'fusses',
    'fussiez',
    'fussions',
    'fut',
    'fûmes',
    'fût',
    'fûtes',
    'il',
    'j',
    'je',
    'l',
    'la',
    'le',
    'leur',
    'lui',
    'm',
    'ma',
    'mais',
    'me',
    'mes',
    'moi',
    'mon',
    'même',
    'ne',
    'nos',
    'notre',
    'nous',
    'on',
    'ont',
    'ou',
    'par',
    'pas',
    'pour',
    'qu',
    'que',
    'qui',
    's',
    'sa',
    'se',
    'sera',
    'serai',
    'seraient',
    'serais',
    'serait',
    'seras',
    'serez',
    'seriez',
    'serions',
    'serons',
    'seront',
    'ses',
    'soient',
    'sois',
    'soit',
    'sommes',
    'son',
    'sont',
    'soyez',
    'soyons',
    'suis',
    'sur',
    't',
    'ta',
    'te',
    'tes',
    'toi',
    'ton',
    'tu',
    'vos',
    'votre',
    'vous',
    'y',
    'à',
    'étaient',
    'étais',
    'était',
    'étant',
    'étante',
    'étantes',
    'étants',
    'étiez',
    'étions',
    'été',
    'étée',
    'étées',
    'étés',
    'êtes',
    'au',
    'aux',
    'avec',
    'ce',
    'ces',
    'dans',
    'de',
    'des',
    'du',
    'elle',
    'en',
    'et',
    'eux',
    'il',
    'je',
    'la',
    'le',
    'leur',
    'lui',
    'ma',
    'mais',
    'me',
    'même',
    'mes',
    'moi',
    'mon',
    'ne',
    'nos',
    'notre',
    'nous',
    'on',
    'ou',
    'par',
    'pas',
    'pour',
    'qu',
    'que',
    'qui',
    'sa',
    'se',
    'ses',
    'son',
    'sur',
    'te',
    'tes',
    'toi',
    'ton',
    'tu',
    'un',
    'une',
    'vos',
    'votre',
    'vous',
    'c',
    'j',
    'l',
    'à',
    'm',
    'n',
    's',
    'y',
    'été',
    'étée',
    'étées',
    'étés',
    'étant',
    'suis',
    'es',
    'est',
    'sommes',
    'êtes',
    'sont',
    'serai',
    'seras',
    'sera',
    'serons',
    'serez',
    'seront',
    'serais',
    'serait',
    'serions',
    'seriez',
    'seraient',
    'étais',
    'était',
    'étions',
    'étiez',
    'étaient',
    'fus',
    'fut',
    'fûmes',
    'fûtes',
    'furent',
    'sois',
    'soit',
    'soyons',
    'soyez',
    'soient',
    'fusse',
    'fusses',
    'fût',
    'fussions',
    'fussiez',
    'fussent',
    'ayant',
    'eu',
    'eue',
    'eues',
    'eus',
    'ai',
    'as',
    'avons',
    'avez',
    'ont',
    'aurai',
    'auras',
    'aura',
    'aurons',
    'aurez',
    'auront',
    'aurais',
    'aurait',
    'aurions',
    'auriez',
    'auraient',
    'avais',
    'avait',
    'avions',
    'aviez',
    'avaient',
    'eut',
    'eûmes',
    'eûtes',
    'eurent',
    'aie',
    'aies',
    'ait',
    'ayons',
    'ayez',
    'aient',
    'eusse',
    'eusses',
    'eût',
    'eussions',
    'eussiez',
    'eussent',
    'ceci',
    'celà',
    'cet',
    'cette',
    'ici',
    'ils',
    'les',
    'leurs',
    'quel',
    'quels',
    'quelle',
    'quelles',
    'sans',
    'soi',
  ]

  let result = string.toLowerCase().trim().split('_').join(' ')
  result = unaccentize(result)

  const stopWords: string[] = []
  rawStopWords.forEach((word) => {
    stopWords.push(unaccentize(word))
  })

  stopWords.forEach((stopWord) => {
    result = result.replace(new RegExp(`\\b${stopWord}\\b`, 'gi'), '')
  })

  return convert(result).substr(0, 150)
}
